# Zeitgeist Rikiddo 评分规则简介

> 一直以来，Zeitgeist 致力于研究了 AMM 模型，以找到适合我们需求的模型。 我们一直在重新审视 MSR 类的 AMM，特别是 Robin Hanson 通过他的预测市场研究发明的对数市场评分规则 (LMSR)，并专门针对此类市场制定了规则。

![image-20210616091806332](https://raw.githubusercontent.com/Whisker17/ImageStoreService/main/image-20210616091806332.png)

## 简介

自动做市商 （AMM） 使用户的交易变得更容易，因为它们消除了交易对手方的需要。 AMM 不再是一个用户之间的点对点交易，而是一个用户和合约的交易。（即交易者不是与另一个交易者进行交易，而是和智能合约中的算法进行交易）
AMM 由一个程序化的成本函数确定的价格持续提供买入和卖出功能。最初的 AMM 是基于市场评分规则（MSR）的，但是在最近的加密货币市场中，诸如恒定乘积成本函数之类的方案得到了更广泛的应用。

Zeitgeist 一直致力于对 MSR 类的 AMM 进行重新审视，特别是对数市场评分规则（LMSR），这是由 Robin Hanson 通过他自己在预测市场和经济学领域的研究发明的，通过对其研究以找到适合我们需求的 AMM。LSMR 自最初提出以来，几位作者提出了对其基本公式的几种变种，同时存在有大量可用的资料可参考。
作为 Zeitgeist 的经济学研究员，我梳理了所有相关文献，并与我们出色的团队将 LMSR 与加密货币领域中流行的更现代的变体进行了比较。 我们在本文中提出了一种 LMSR 的新变体，即“流动性敏感动态 LMSR”。我们将此评分规则称为“Rikiddo Scoring Rule”，而“Rikiddo”是一个日语单词，意思是 “流动性”。
在本文中，我们将探索市场评分规则的不同变体，展示与我们的用例上下文相关的利弊。最后，我们将展示我们自己的模型：**The Rikiddo Scoring Rule**，根据它的主要特征和论据，我们认为它是一个很好的评分规则，也是最适合我们生态的评分规则。正如我们在后文将看到的，我们做出的主要改进是可以使用内生变量动态调整其费用。

## LMSR：基础介绍

当您处于预测市场时，做市商需要对市场做出两个基本决策：

- **合约类型的选择**
- **市场机制**

本次的重点在于市场机制，我们将会在另一篇博客中介绍合同类型的相关内容。

市场机制规定了市场参与者如何进行交易。Robin Hanson(2007)[1]提出了一个市场评分规则，或“顺序共享评分规则”，它要求市场参与者提供连续的预测，该规则就像一个自动做市商，不断地根据价格函数定义的价格买卖合约。

在预测市场使用的几种评分规则中，对数市场评分规则（LMSR）最受欢迎。这个评分规则给予人们经济激励，让他们对未来的事件发表真实的意见。
LMSR 的成本和价格函数是迄今为止出售的每种结果的股份净额的函数。对于每个结果都有一个市场上股票数量 **q** 的向量，成本函数为：

![](https://raw.githubusercontent.com/Whisker17/ImageStoreService/main/image-20210628223353385.png)

如果我们对成本函数 **C(q)** 进行推导，我们将得到价格函数（是一个偏导的关系），但我们将用这个函数来说明这一点。 **b** 这个参数作为一种 “流动性参数” ，是市场开始之前手动设置的。 尽管如此，像 Lekwijit (2019) *[2]* 等学者表明，该参数不仅影响流动性参数，还影响做市商将承担的最大损失和价格的适应性。 

比如 b 越小表示市场流动性越低。这意味着市场价格将会有很大的波动，我们将会有一个更具适应性的市场。因此，这意味着做市商的最大损失较小。为什么?

做市商的最坏情况损失发生在交易者非常确定结果，并最终改变实现结果的市场概率为 **1** 的情况下。如果市场以 **M** 个结果的均匀概率分布开始，做市商最坏情况下的损失为 bln⁡M 。因此，如果做市商想以最小的损失操作市场，他必须将 b 的值设得尽可能小。

你可以这样想:

- 在任何时候，市场都在显示其真正的价值。
- 这些信号被发送给交易员，他们将解读这些信号并执行与此信号相关的操作(买入或卖出)。
- 如果市场信号明确，交易员据此行动，真实的市场结果将是已知的，由此产生的市场概率将变为1。

对于高流动性的市场（ **b** 比较大），市场价格达到其实际价值所需的步骤较少，因为数量的连续变化将以渐进和受控的方式发生。 在流动性低（ **b** 比较小）的市场中，数量的变化会发生得更突然，围绕实际价值产生更长的振荡，对真实结果的确定性降低。 市场波动越大，交易者对结果实现的可能性就越不确定。

因此在我们的案例中，我们所需要的这样一个对市场行为监管如此重要的参数必须受市场状态的影响（从而进行动态调整），而不是一个 依赖于对其行为信号的解释的外部固定值。

## LS-LMSR：曙光初现

Othman 和 Sandholm 提出了一种提高流动性参数的有趣[方法](https://www.cs.cmu.edu/~sandholm/profitChargingMarketMaker.ec12.pdf)，他们指出价格规则不能同时具有路径独立性、非套利性和流动性敏感度三种特性。

![表示 MSR 的特征。正如我们所说的，这三个需求代表了一个三难困境，而我们只能拥有其中的两个](https://raw.githubusercontent.com/Whisker17/ImageStoreService/main/image-20210628225400770.png)

因此，他们提出了一个流动性系数，该系数取决于 alpha 系数和市场规模（市场上交易的合约数量的总和）。

![image-20210616114135822](https://raw.githubusercontent.com/Whisker17/ImageStoreService/main/image-20210616114135822.png)

其中 𝛼 是一个固定参数。然而，作者已经表明这带来了一个协议本身存在的问题：**如果在大量交易已经发生之后发生突然上涨，这种机制对标的价值的适应非常缓慢。**
我们来头脑风暴一下：据作者所说，这个模型的主要成本是为初始状态种子资金。同时，市场运营者不使用任何外部信息或过去的价格信息来做决定。那么，之前的模型因参数固定而受到批评，而在这个模型中，我们添加了一个新参数，但乘以另一个固定参数。

在这个规则的使用下，我们依旧面临无法从市场中捕捉不断变化的信号并对其进行适应的问题，需要不断地手动调整参数。如果是针对那些同时存在比较少数量的市场的情况，这可以是一种选择，但这并不符合我们的情况。这就是为什么有必要继续寻找允许自动且动态调整的规则（“自动”是指无需手动修改即可更改参数的能力。）适应这些变化。

## 动态做市商

直到这一刻，我们已经了解了一些静态确定费用的模型：他们收取固定费用并保持不变。他们感知到市场以某种方式发生变化的信号，AMM 会调整其行为（参数）。由于多种原因，这种方案的效率不尽如人意，其中主要有两点：

1. **参数的变化是离散的。**只有当算法感知到市场结构的重大变化时，它们才会发生变化。
2. **他们提出做市商事后调整**，意味着在这个变化（价格暴涨，突然的信息影响等）发生后参数会发生变化，所以调整是为了未来的结果，但他们无法解决瞬时影响。

出于以上原因，我们最终找到了一种由 Kguyen、Luu 和 Ng 提出的动态做市商 （DMM）[方案](https://files.kyber.network/DMM-Feb21.pdf)。他们提出了一种向做市商增加动态费用的方法。首先，他们计算池中两种资产的价格之间的相关性，表现它们彼此之间的相似程度。在此之后，将根据参数的相关性提供参数列表（考虑到较低的相关性意味着较高的差异）。提供的参数之一是资产的初始费用。除此之外，还要计算动态费用，这取决于一些可变因素，例如**价格**或**交易量**。作者使用了短期和长期的交易量之间的比率，这是一个合理的方案，因为这是链上数据。
基于此模型，您可以提供费用的连续变化，主要是它通过增加费用（以及因此而增加买入价/卖出价）来阻止高波动时期的交易（当交易者因价格差异而倾向于赚取市场利润时），反之通过降低费用来鼓励低波动时期的交易。

## 检查点

到目前为止，我们已经展示了三个模型，我们希望 MSR 具有三个强大的类别：
- 强鲁棒性的结构 （LMSR）。
- 适应流动性变化的能力（LS-LMSR）。
- 能够根据市场状况调整比率以激励或阻止交易（DMM）。

基于这三个特征，我们将产生我们自己的 MSR：流动性敏感动态 LMSR，即 **Rikiddo** 。

## Rikiddo 评分规则：原力觉醒

在我们开始定义我们的模型之前，我们需要了解流动性、波动性及其关系。 在谈论池中流动性的增加时，我们直接将其与池中资产数量的增加联系起来。 我们在引用的论文中观察到，池中的资产数量通常被称为存量变量，但没有考虑使其变化的流量。

举例说明一下：如果我们有一个有水的水池，我们想给它注水，我们只考虑它在某个时期的水位，而没有考虑它注水的流量，我们也没有考虑泄漏导致水的流失的可能性。继续类比；现有的泄漏往往随着填充流量和池容量的增加而增加，因此做市商应通过对改变池水平（输入和输出）的流量征收更高的费用来减少泄漏的可能性。

因此，从技术上讲，波动性与流量有关，但流动性是其差异（存量）的结果。

要记住的另一件事是交易者有可能利用流量不规则（套利机会）。这为更有经验的交易者带来了利润，但对流动性提供者造成了损失。这就是为什么制定一个规范流量的市场评分规则很重要的原因。

现在，我们回到我们的模型。

该模型从 LS-LMSR 开始衍生，其成本函数如下：

![image-20210616123918340](https://raw.githubusercontent.com/Whisker17/ImageStoreService/main/image-20210616123918340.png)

![image-20210616123932148](https://raw.githubusercontent.com/Whisker17/ImageStoreService/main/image-20210616123932148.png)

就像我们之前说的，这个模型包含一个 a 值，可以解释为做市商收取的佣金。a 越大，佣金越多。 将此参数设为固定值意味着至少在出现此问题时，此模型不会考虑价格冲击或结构变化（例如，某些信息会改变市场认知，影响特定资产，增加其交易量） 发生，然后做市商必须调整其参数。 出于这个原因，我们提出了一个由 2 个因素组成的参数，

![image-20210616123957901](https://raw.githubusercontent.com/Whisker17/ImageStoreService/main/image-20210616123957901.png)

其中 f 是初始固定费用，是表示取决于 r 参数的费用可变部分的函数。 让我们更多地了解这两个参数。
这些值遵循动态做市商的属性，其中 f 将取决于将位于池中的资产之间预先存在的关系：相关性越高，此费用越低。 f 的结构类似于最初来自 LS-LMSR 的结构：



其中 n 为池内资产数量，vig(vigorish)是根据资产之间的相关性变化的系数，代表庄家愿意接受的费用。 对于不同的资产和相关系数，我们制作了一个相关的 vig 值表



另一方面，η 是一个关于 r 的函数，r 是 t 周期间隔与另一个 t+k 周期间隔中的市场容量之间的比率。 在我们的例子中，我们将使用指数移动平均线，但加权移动平均线（或简单移动平均线）也可以是一种选择。



此外，η(𝑟) 满足以下条件



该函数可以采用满足先决条件的任何形式。 关于函数类型要考虑的重要一点是，它将根据移动平均线之间的比率变化来调节动态费用。 我们将使用 Sigmoid 函数：



这意味着 η 随着 r 的增加在刚开始会有更明显的斜率。 这样做的目的是为了激励在早期阶段产生减少交易量，因此我们可以将其控制在较小的范围内（这样去做到一个以可控的方式达到流动性，同时避免高波动性）。 此外，初始值可以是正数（如果 r>0）或负数（如果 r<0），这意味着总费用可以小于 f。 该值将限制初始费用，以激励在低波动时期进行交易，并阻止在高波动时期进行交易。

鉴于我们可以收取低于 f 的费用，因此有必要引入另一个新概念：最小收入系数 (ω)，由下式给出：



该值是 f 的比例缩小，并确保流动性提供者的利润为正。 话虽如此，我们可以重新定义 b 参数：



因此，成本函数由下式给出：



新状态的成本函数（q+Δq）与前一状态（q）的差值代表了交易的成本。

我们现在有了我们的模型，但我们需要添加一个重要的特征：当市场流动性耗尽时的 AMM 行为。 在这种情况下，我们将大幅提高费用，以阻止与该资产相关的任何可能类型的交易。 这个提高的系数现在是一个临时值。

定义了所有这些参数后，我们最终可以说这些参数都与外界无关，因此我们可以用链上数据定义我们的值。 我们认为这是一种最佳改进，因为现在可以使用来自每个特定案例的数据以动态方式分析和验证模型的参数和限制。 然而，我们不能忽视这样一个事实，即在最初的情况下，需要设置一个基准值，以便以后可以根据每个特定市场提出的需求对其进行处理和更改。

## 结论

这篇文章是根据我的研究起草的，目的是展示多种版本的市场评分规则。我们团队通过确定、概述甚至测试了这些规则的不同迭代，设计了我们自己的评分规则，我们称之为“Rikiddo 评分规则”。

综上所述，我们新开发的 Rikiddo 评分规则具有三个主要特征：

1) 其比率是动态调整的，允许市场在必要时鼓励或阻止交易；

2) 不需要像参数固定的规则那样在突然的市场信号之后修改参数（指数移动平均线负责其调节）；

3）所有参数都是内生的，因此它们的确定和验证将仅取决于链上数据。

尽管我们相信这样一个市场评分规则已经取得了重大进展，但我们将继续耕耘此领域，以动态适应市场中经常出现的情况。

### 后续工作

近期，我们已经计划了一些后续持续关注的领域，以改进这个新设计的 Rikiddo 评分规则：

- 使用相对交易量费用而不是绝对交易量费用：目前我们的动态费用是根据流动性池内的总交易量计算的，但理想的情况是考虑单个资产量的变化，这将导致每个资产不同的动态费用。这种改进带来了进行额外计算的计算成本。
- Rikiddo 在组合市场中的使用：对于当前的工作，我们使用了二元预测市场的例子，但预测市场的一个重要用途是组合学，其中预测是在组合空间中定义的。

我们希望本文对您了解我们的评分规则的制定和实现有所帮助，我们欢迎您通过电子邮件“hi@zeitgeist.pm”提供任何反馈——我们很乐意收到您的来信。

感谢您阅读并关注我们在 Zeitgeist 构建有效预测市场协议的工作。

id: 3fc5afad52904bf19360eef132115f68
parent_id: 702275d4a3a84c46aabb81c01ccc7c33
created_time: 2021-06-16T01:17:53.438Z
updated_time: 2021-06-29T11:39:36.170Z
is_conflict: 0
latitude: 0.00000000
longitude: 0.00000000
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2021-06-16T01:17:53.438Z
user_updated_time: 2021-06-29T11:39:36.170Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
type_: 1